<!doctype html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <title>MarkDown Opos</title>
  <style>
    body {
      background-color: #121212;
      color: #e0e0e0;
    }

    select.form-select {
      background-color: #1e1e1e;
      color: #e0e0e0;
    }

    #markdown-container {
      background-color: #1e1e1e;
      color: #e0e0e0;
      padding: 1rem;
      border-radius: 0.5rem;
      margin-top: 1rem;
    }

    /* Ajustes para Markdown */
    #markdown-container h1,
    #markdown-container h2,
    #markdown-container h3,
    #markdown-container h4 {
      border-bottom: 1px solid #444;
      padding-bottom: 0.3em;
      margin-top: 1em;
      margin-bottom: 0.5em;
    }

    #markdown-container pre {
      background-color: #2d2d2d;
      color: #e0e0e0;
      padding: 0.5rem;
      border-radius: 0.3rem;
    }

    #markdown-container code {
      background-color: #2d2d2d;
      padding: 0.2rem 0.4rem;
      border-radius: 0.3rem;
    }

    #markdown-container table {
      width: 100%;
      border-collapse: collapse;
    }

    #markdown-container th,
    #markdown-container td {
      border: 1px solid #555;
      padding: 0.5rem;
    }

    #markdown-container a {
      color: #66ccff;
    }

    #markdown-container p img {
      display: block;
      margin: 0 auto;
    }

    #markdown-container img {
      width: 50% !important;
      max-width: none;
      aspect-ratio: 1/1;
      object-fit: contain;
    }

    .navegador {
      background-color: #161616;
      padding-bottom: 30px;
      border-radius: 10px;
    }
  </style>
</head>

<body class="p-4">

  <div class="container">
    <h1 class="mb-4">Visor de Markdown</h1>

    <div class="row g-3 navegador">
      <div class="col-md-3">
        <label class="form-label">B-1</label>
        <select id="select1" class="form-select">
          <option value="ninguno" selected>Organización del Estado y Administración electrónica</option>

        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">B-2</label>
        <select id="select2" class="form-select">
          <option value="ninguno" selected>Selecciona o personaliza</option>

        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">B-3</label>
        <select id="select3" class="form-select">
          <option value="ninguno" selected>Selecciona o personaliza</option>

        </select>
      </div>
      <div class="col-md-3">
        <label class="form-label">B-4</label>
        <select id="select4" class="form-select">
          <option value="ninguno" selected>Selecciona o personaliza</option>

        </select>
      </div>
    </div>

    <div id="markdown-container" class="mt-4">
      <p>Aquí se mostrará el contenido del archivo seleccionado...</p>
    </div>
  </div>

  <script>
    fetch('markdown_files.json')
      .then(response => response.json())
      .then(data => {
        const carpetas = Object.keys(data);

        carpetas.forEach((carpeta, idx) => {
          const selectId = `select${idx + 1}`;
          const select = document.getElementById(selectId);

          // Añade la opción inicial editable en HTML (no tocamos en JS)
          // Las opciones dinámicas:
          data[carpeta].forEach(archivo => {
            const option = document.createElement('option');
            option.value = archivo.ruta;
            option.textContent = archivo.nombre;
            select.appendChild(option);
          });

          // Cuando cambie la selección
          select.addEventListener('change', function () {
            if (this.value === 'ninguno' || this.value === '') {
              document.getElementById('markdown-container').innerHTML = '<p class="text-gray-500">No se ha seleccionado ningún archivo.</p>';
              return;
            }
            cargarMarkdown(this.value);
          });
        });

        function cargarMarkdown(ruta) {
          fetch(ruta)
            .then(r => r.text())
            .then(md => {
              const html = marked.parse(md);
              document.getElementById('markdown-container').innerHTML = html;
            })
            .catch(err => {
              document.getElementById('markdown-container').innerHTML = '<p class="text-danger">Error al cargar el archivo.</p>';
              console.error(err);
            });
        }
      })
      .catch(err => {
        console.error('Error al cargar el JSON:', err);
        document.getElementById('markdown-container').innerHTML = '<p class="text-danger">Error al cargar la lista de archivos.</p>';
      });



  </script>

</body>

</html>